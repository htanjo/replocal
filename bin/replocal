#!/usr/bin/env node
'use strict';

var program = require('commander');
var replocal = require('../lib');
var pkg = require('../package.json');

function exec(program) {

  if (!program.args.length) {
    console.error('No <hostname> specified');
    program.help();
  }

  var options = {
    hostname: program.args[0],
    path: program.args[1],
    port: program.port
  };

  replocal(options);

};

program
  .version(pkg.version)
  .usage('[options] <hostname> [<directory>]')
  .description([
    '  Start proxy server for replacing web contents with local files.',
    '  Your current directory will be mapped to document root by default.',
    '  If you want to change document root, specify <directory> argument.'
  ].join('\n  '))
  .option('--port <number>', 'port number of proxy server (default: 8888)', parseInt);

program.on('--help', function () {
  console.log('  Examples:');
  console.log('');
  console.log('    $ replocal example.com');
  console.log('    $ replocal --port=9999 example.com path/to/docroot');
  console.log('');
});

program.parse(process.argv);

exec(program);
